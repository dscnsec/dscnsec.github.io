!function(t){var e=t('<div class="stb-select-container"><span class="selected"></span></div>'),n=t('<ul class="stb-select" style="display:none;"></ul>');t.fn.stbDropdown=function(){var i=t(this);i.hide(),i.each(function(i,a){var o=e.clone(),s=n.clone(),r=t(a),c=r.find("option");r.after(o),r.appendTo(o),s.appendTo(o),c.each(function(e,n){var i=t(n),a=t("<li></li>"),o=i.prop("attributes");a.prop("attributes",o),t.each(o,function(t,e){a.attr(e.name,e.value)}),a.append(i.text()),s.append(a)});var l,p=r.children("option").filter(function(e,n){return t(n).is("[selected]")});l=0==p.length?c.first():p.first(),o.find(".selected").text(l.text()),o.on("click.stb.select",function(){var e=t(this),n=t.grep(t(".stb-select-container"),function(n){return!e.is(t(n))});t(n).find("ul").hide(),e.find("ul").toggle()}),o.on("click.stb.option","li",function(e){e.stopPropagation();var n=t(this),i=n.parents(".stb-select-container"),a=i.find("span.selected");a.text(n.text()),n.parents("ul").toggle();var o=i.find("select");o.val(n.attr("value")).change(),n.siblings().removeAttr("selected"),n.attr("selected","selected")}),r.on("DOMNodeInserted",function(e){var n=t(e.target);if(n.is("option")){var i=t("<li></li>"),a=n.prop("attributes");i.prop("attributes",a),t.each(a,function(t,e){i.attr(e.name,e.value)}),i.append(n.text()),s.append(i)}}),r.on("DOMNodeRemoved",function(e){var n=t(e.target);n.is("option")&&s.find("li:contains('"+n.text()+"')").remove()})})}}(jQuery);

$('select').stbDropdown();